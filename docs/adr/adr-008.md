# ADR 008: Coding Standards & Static Analysis

## Metadata
* **Status:** ACCEPTED
* **Date:** 2026-01-30
* **Deciders:** Dmytro Shulha
* **Stakeholders Consulted:** N/A

## 1. Context (The Forces)
To maintain high code quality and consistency across the project, we need automated tools to catch common programming errors, code smells, and formatting issues.

* **Business:** Reducing technical debt and preventing bugs from reaching production.
* **Technological:** Kotlin-centric project. Need for tools that understand Kotlin-specific idioms.
* **Project-local:** Integration with GitHub Actions for automated feedback on PRs.

## 2. Options Considered
* **Option 1: Detekt & Kotlin Lint (ktlint)**
  * **Pros/Cons:** Standard in the Kotlin ecosystem. Detekt catches logic smells, while ktlint ensures formatting consistency. Very fast and easy to integrate with Gradle.
* **Option 2: SonarCloud / SonarQube**
  * **Pros/Cons:** Extremely powerful and provides a broad overview of project health. Integrates well with GitHub branches. However, it requires an external service and can be more complex to configure for individual developers compared to local Gradle tasks.
* **Option 3: Android Lint only**
  * **Pros/Cons:** Built into the Android SDK. Good for Android-specific issues but lacks the deep Kotlin static analysis provided by Detekt.

## 3. Decision Outcome
**Chosen Option: Detekt & Kotlin Lint (ktlint)**

* **Rationale:** This combination provides the best balance of deep analysis and formatting enforcement without requiring external infrastructure for every developer. It is lightweight and highly configurable via YAML/EditorConfig. While SonarCloud is powerful, Detekt/ktlint provide faster feedback loops during local development.
* **Rejected Options:** SonarCloud was rejected as the primary enforcement tool to keep the toolchain simple and locally executable, though it can be used as a secondary oversight tool. Relying only on Android Lint was rejected because it doesn't enforce strict Kotlin formatting and smells as well as Detekt.

## 4. Consequences
* **{+} Positive:** Automatic enforcement of coding standards.
* **{+} Positive:** Fewer "nitpick" comments in code reviews regarding formatting.
* **{+} Positive:** Early detection of potential bugs (e.g., complex functions, unused variables).
* **{-} Negative:** Requires developers to periodically fix lint/detekt warnings to pass CI.

## 5. Validation & Compliance
* The `pr-ci.yml` workflow fails if there are any Detekt or Lint violations.
* Developers are encouraged to run `./gradlew detektCheck` locally before pushing.

## 6. Links & References
* [Detekt Website](https://detekt.dev/)
* [ktlint Website](https://pinterest.github.io/ktlint/)
* Back to [Log](../adl.md)
