# ADR 006: Asynchronous Programming & Streams

## Metadata
* **Status:** ACCEPTED
* **Date:** 2026-01-30
* **Deciders:** Dmytro Shulha
* **Stakeholders Consulted:** N/A

## 1. Context (The Forces)
The app needs to handle background operations like database access and game timer updates, and propagate these changes to the UI reactively.

* **Business:** Smooth user experience without UI freezes.
* **Technological:** Kotlin-based project. Need for structured concurrency to avoid memory leaks.
* **Project-local:** Integration with Room and Compose is a priority.

## 2. Options Considered
* **Option 1: Kotlin Coroutines & Flow**
  * **Pros/Cons:** Native to Kotlin, lightweight, excellent support for structured concurrency, and first-class integration with Room and Compose.
* **Option 2: RxJava / RxKotlin**
  * **Pros/Cons:** Very powerful and mature, but high learning curve, significant library size, and not as "natural" in a modern Kotlin/Compose stack.
* **Option 3: LiveData**
  * **Pros/Cons:** Simple and lifecycle-aware, but limited to the main thread and lacks the powerful transformation operators of Flow. Considered "legacy" for pure Kotlin projects.

## 3. Decision Outcome
**Chosen Option: Kotlin Coroutines & Flow**

* **Rationale:** Coroutines provide a simple way to write asynchronous code sequentially, while Flow offers a robust, cold-stream implementation that integrates perfectly with the reactive nature of Jetpack Compose.
* **Rejected Options:** RxJava was rejected due to its complexity and overhead. LiveData was rejected in favor of the more modern and flexible Flow API.

## 4. Consequences
* **{+} Positive:** Clean, readable asynchronous code.
* **{+} Positive:** Seamless integration with Jetpack Compose via `collectAsStateWithLifecycle`.
* **{+} Positive:** Structured concurrency ensures background tasks are cancelled when no longer needed.
* **{-} Negative:** Requires understanding of Coroutine Scopes and Flow operators.

## 5. Validation & Compliance
* Code reviews to ensure `viewModelScope` is used for background tasks.
* Proper use of `Dispatchers` (IO for DB, Default for logic).

## 6. Links & References
* [Kotlin Coroutines Guide](https://kotlinlang.org/docs/coroutines-overview.html)
* Back to [Log](../adl.md)
